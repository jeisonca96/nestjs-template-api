{
  "/Users/jeisonaparicio/Documents/Programming/nestjs-template-api/serverless.yml": {
    "versionFramework": "4.23.0",
    "servicePath": "/Users/jeisonaparicio/Documents/Programming/nestjs-template-api/serverless.yml",
    "serviceConfigFileName": "serverless.yml",
    "service": {
      "service": "nestjs-template-api",
      "frameworkVersion": "4",
      "useDotenv": true,
      "provider": {
        "name": "aws",
        "runtime": "nodejs20.x",
        "stage": "prod",
        "region": "us-east-1",
        "memorySize": 512,
        "timeout": 30,
        "architecture": "arm64",
        "environment": {
          "NODE_ENV": "production",
          "DATABASES_MONGO_URL": "mongodb+srv://jeisonca96:uVsmEfrQsBGnA0Om@cluster0.pcs9x.mongodb.net/doctors-api?authSource=admin",
          "JWT_SECRET": "<REDACTED>",
          "JWT_EXPIRES_IN": "1d",
          "S3_BUCKET_NAME": ""
        },
        "iam": {
          "role": {
            "statements": [
              {
                "Effect": "Allow",
                "Action": [
                  "s3:GetObject",
                  "s3:PutObject",
                  "s3:DeleteObject"
                ],
                "Resource": "arn:aws:s3:::/*"
              },
              {
                "Effect": "Allow",
                "Action": [
                  "logs:CreateLogGroup",
                  "logs:CreateLogStream",
                  "logs:PutLogEvents"
                ],
                "Resource": "arn:aws:logs:us-east-1:*:*"
              },
              {
                "Effect": "Allow",
                "Action": [
                  "secretsmanager:GetSecretValue"
                ],
                "Resource": "arn:aws:secretsmanager:us-east-1:*:secret:*"
              }
            ]
          }
        },
        "apiGateway": {
          "shouldStartNameWithService": true,
          "minimumCompressionSize": 1024,
          "binaryMediaTypes": [
            "multipart/form-data",
            "image/*",
            "application/octet-stream"
          ]
        },
        "logs": {
          "restApi": true
        },
        "tracing": {
          "lambda": true,
          "apiGateway": true
        }
      },
      "custom": {
        "serverless-offline": {
          "httpPort": 3000,
          "lambdaPort": 3002,
          "noPrependStageInUrl": true,
          "noAuth": true
        },
        "optimize": {
          "external": [
            "@nestjs/microservices",
            "@nestjs/websockets",
            "class-transformer/storage"
          ],
          "excludeFiles": "**/*.spec.ts"
        }
      },
      "functions": {
        "main": {
          "handler": "dist/lambda.handler",
          "events": [
            {
              "http": {
                "method": "ANY",
                "path": "/",
                "cors": true
              }
            },
            {
              "http": {
                "method": "ANY",
                "path": "{proxy+}",
                "cors": true
              }
            }
          ]
        }
      },
      "plugins": [
        "serverless-offline",
        "serverless-plugin-optimize"
      ],
      "package": {
        "individually": true,
        "exclude": [
          "node_modules/**",
          "test/**",
          "coverage/**",
          "scripts/**",
          "k8s/**",
          "docker-compose*.yml",
          "Dockerfile*",
          "**/*.spec.ts",
          "**/*.test.ts",
          ".git/**",
          ".github/**",
          ".vscode/**",
          "*.md"
        ],
        "include": [
          "dist/**",
          "node_modules/@nestjs/**",
          "node_modules/@codegenie/**",
          "node_modules/express/**",
          "src/**/*.hbs"
        ]
      },
      "resources": {
        "Resources": {
          "MainLogGroup": {
            "Type": "AWS::Logs::LogGroup",
            "Properties": {
              "LogGroupName": "/aws/lambda/nestjs-template-api-prod-main",
              "RetentionInDays": 30
            }
          }
        },
        "Outputs": {
          "ApiGatewayRestApiId": {
            "Description": "API Gateway REST API ID",
            "Value": {
              "Ref": "ApiGatewayRestApi"
            },
            "Export": {
              "Name": "nestjs-template-api-prod-ApiGatewayRestApiId"
            }
          },
          "ApiEndpoint": {
            "Description": "API Gateway Endpoint URL",
            "Value": {
              "Fn::Sub": "https://${ApiGatewayRestApi}.execute-api.${AWS::Region}.amazonaws.com/prod"
            }
          },
          "MainLambdaFunctionArn": {
            "Description": "Main Lambda Function ARN",
            "Value": {
              "Fn::GetAtt": [
                "MainLambdaFunction",
                "Arn"
              ]
            },
            "Export": {
              "Name": "nestjs-template-api-prod-MainLambdaFunctionArn"
            }
          }
        }
      }
    },
    "provider": {
      "name": "aws",
      "runtime": "nodejs20.x",
      "stage": "prod",
      "region": "us-east-1",
      "memorySize": 512,
      "timeout": 30,
      "architecture": "arm64",
      "environment": {
        "NODE_ENV": "production",
        "DATABASES_MONGO_URL": "mongodb+srv://jeisonca96:uVsmEfrQsBGnA0Om@cluster0.pcs9x.mongodb.net/doctors-api?authSource=admin",
        "JWT_SECRET": "<REDACTED>",
        "JWT_EXPIRES_IN": "1d",
        "S3_BUCKET_NAME": ""
      },
      "iam": {
        "role": {
          "statements": [
            {
              "Effect": "Allow",
              "Action": [
                "s3:GetObject",
                "s3:PutObject",
                "s3:DeleteObject"
              ],
              "Resource": "arn:aws:s3:::/*"
            },
            {
              "Effect": "Allow",
              "Action": [
                "logs:CreateLogGroup",
                "logs:CreateLogStream",
                "logs:PutLogEvents"
              ],
              "Resource": "arn:aws:logs:us-east-1:*:*"
            },
            {
              "Effect": "Allow",
              "Action": [
                "secretsmanager:GetSecretValue"
              ],
              "Resource": "arn:aws:secretsmanager:us-east-1:*:secret:*"
            }
          ]
        }
      },
      "apiGateway": {
        "shouldStartNameWithService": true,
        "minimumCompressionSize": 1024,
        "binaryMediaTypes": [
          "multipart/form-data",
          "image/*",
          "application/octet-stream"
        ]
      },
      "logs": {
        "restApi": true
      },
      "tracing": {
        "lambda": true,
        "apiGateway": true
      }
    },
    "dashboard": {
      "isEnabledForService": false,
      "requiredAuthentication": false,
      "orgFeaturesInUse": null,
      "orgObservabilityIntegrations": null,
      "serviceAppId": null,
      "serviceProvider": null,
      "instanceParameters": null
    },
    "error": {
      "message": "Cannot resolve '${env:JWT_SECRET}' variable at 'provider.environment.JWT_SECRET'. No value is available for this variable, and no default value was provided. Please check your variable definitions or provide a default value.",
      "stack": "Error: Cannot resolve '${env:JWT_SECRET}' variable at 'provider.environment.JWT_SECRET'. No value is available for this variable, and no default value was provided. Please check your variable definitions or provide a default value.\n    at _ResolverManager.resolve (file:///Users/jeisonaparicio/.serverless/releases/4.23.0/package/dist/sf-core.js:723:32221)\n    at async #handlePlaceholderNode (file:///Users/jeisonaparicio/.serverless/releases/4.23.0/package/dist/sf-core.js:723:30428)\n    at async file:///Users/jeisonaparicio/.serverless/releases/4.23.0/package/dist/sf-core.js:723:28278\n    at async processNodeAndHandleCompletion (file:///Users/jeisonaparicio/.serverless/releases/4.23.0/package/dist/sf-core.js:723:16690)",
      "code": "MISSING_VARIABLE_RESULT"
    },
    "serviceRawFile": "service: nestjs-template-api\n\nframeworkVersion: '4'\n\nuseDotenv: true\n\nprovider:\n  name: aws\n  runtime: nodejs20.x\n  stage: prod\n  region: ${env:AWS_REGION, 'us-east-1'}\n  memorySize: 512\n  timeout: 30\n  architecture: arm64 # Use ARM64 for better performance and cost\n  \n  # Environment variables\n  environment:\n    NODE_ENV: production\n    DATABASES_MONGO_URL: ${env:DATABASES_MONGO_URL}\n    JWT_SECRET: ${env:JWT_SECRET}\n    JWT_EXPIRES_IN: ${env:JWT_EXPIRES_IN, '1d'}\n    S3_BUCKET_NAME: ${env:S3_BUCKET_NAME, ''}\n    # Add other environment variables as needed\n  \n  # IAM Role permissions\n  iam:\n    role:\n      statements:\n        - Effect: Allow\n          Action:\n            - s3:GetObject\n            - s3:PutObject\n            - s3:DeleteObject\n          Resource: \"arn:aws:s3:::${env:S3_BUCKET_NAME, 'your-bucket-name'}/*\"\n        - Effect: Allow\n          Action:\n            - logs:CreateLogGroup\n            - logs:CreateLogStream\n            - logs:PutLogEvents\n          Resource: \"arn:aws:logs:${self:provider.region}:*:*\"\n        - Effect: Allow\n          Action:\n            - secretsmanager:GetSecretValue\n          Resource: \"arn:aws:secretsmanager:${self:provider.region}:*:secret:*\"\n  \n  # VPC Configuration (uncomment if your MongoDB is in VPC)\n  # vpc:\n  #   securityGroupIds:\n  #     - sg-xxxxxxxxx\n  #   subnetIds:\n  #     - subnet-xxxxxxxxx\n  #     - subnet-yyyyyyyyy\n\n  # API Gateway settings\n  apiGateway:\n    shouldStartNameWithService: true\n    minimumCompressionSize: 1024 # Enable compression for responses over 1KB\n    binaryMediaTypes:\n      - 'multipart/form-data'\n      - 'image/*'\n      - 'application/octet-stream'\n  \n  # CloudWatch Logs\n  logs:\n    restApi: true\n    \n  # Tracing\n  tracing:\n    lambda: true\n    apiGateway: true\n\ncustom:\n  # Serverless Offline configuration for local testing\n  serverless-offline:\n    httpPort: 3000\n    lambdaPort: 3002\n    noPrependStageInUrl: true\n    noAuth: true\n  \n  # Optimization settings\n  optimize:\n    external:\n      - '@nestjs/microservices'\n      - '@nestjs/websockets'\n      - 'class-transformer/storage'\n    excludeFiles: '**/*.spec.ts'\n\nfunctions:\n  main:\n    handler: dist/lambda.handler\n    events:\n      - http:\n          method: ANY\n          path: /\n          cors: true\n      - http:\n          method: ANY\n          path: '{proxy+}'\n          cors: true\n    # Reserved concurrency (optional, prevents over-provisioning)\n    # reservedConcurrency: 10\n    \n    # Provisioned concurrency for production (optional, reduces cold starts)\n    # provisionedConcurrency: 2\n\nplugins:\n  - serverless-offline\n  - serverless-plugin-optimize\n\n# Package settings\npackage:\n  individually: true\n  exclude:\n    - node_modules/**\n    - test/**\n    - coverage/**\n    - scripts/**\n    - k8s/**\n    - docker-compose*.yml\n    - Dockerfile*\n    - '**/*.spec.ts'\n    - '**/*.test.ts'\n    - '.git/**'\n    - '.github/**'\n    - '.vscode/**'\n    - '*.md'\n  include:\n    - dist/**\n    - node_modules/@nestjs/**\n    - node_modules/@codegenie/**\n    - node_modules/express/**\n    - src/**/*.hbs\n\n# Resources (optional - add DynamoDB tables, S3 buckets, etc.)\nresources:\n  Resources:\n    # Example: DynamoDB table for rate limiting\n    # RateLimitTable:\n    #   Type: AWS::DynamoDB::Table\n    #   Properties:\n    #     TableName: ${self:service}-rate-limit-${self:provider.stage}\n    #     AttributeDefinitions:\n    #       - AttributeName: id\n    #         AttributeType: S\n    #     KeySchema:\n    #       - AttributeName: id\n    #         KeyType: HASH\n    #     BillingMode: PAY_PER_REQUEST\n    #     TimeToLiveSpecification:\n    #       AttributeName: ttl\n    #       Enabled: true\n    \n    # CloudWatch Log Group with retention\n    MainLogGroup:\n      Type: AWS::Logs::LogGroup\n      Properties:\n        LogGroupName: /aws/lambda/${self:service}-prod-main\n        RetentionInDays: 30\n\n  # CloudFormation Outputs\n  Outputs:\n    ApiGatewayRestApiId:\n      Description: API Gateway REST API ID\n      Value:\n        Ref: ApiGatewayRestApi\n      Export:\n        Name: ${self:service}-prod-ApiGatewayRestApiId\n    \n    ApiEndpoint:\n      Description: API Gateway Endpoint URL\n      Value:\n        Fn::Sub: https://${ApiGatewayRestApi}.execute-api.${AWS::Region}.amazonaws.com/prod\n    \n    MainLambdaFunctionArn:\n      Description: Main Lambda Function ARN\n      Value:\n        Fn::GetAtt:\n          - MainLambdaFunction\n          - Arn\n      Export:\n        Name: ${self:service}-prod-MainLambdaFunctionArn\n",
    "command": [
      "offline"
    ],
    "options": {},
    "orgId": "4444bbbb-ce9b-4a06-96b1-db0d773c17b1",
    "orgName": "jamless",
    "userId": "GKdrpkjDJ17YqYfc6s",
    "userName": "jamless",
    "serviceProviderAwsCfStackId": null,
    "serviceProviderAwsCfStackCreated": null,
    "serviceProviderAwsCfStackUpdated": null,
    "serviceProviderAwsCfStackStatus": null,
    "serviceProviderAwsCfStackOutputs": null
  }
}